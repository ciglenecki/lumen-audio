{
	"openapi": "3.0.2",
	"info": {
		"title": "FastAPI",
		"description": "\n# Before consuming the endpoints set the variable `MODEL_DIRECTORY` in `.env` to a directory that contains model checkpoints (.ckpt). Models outside of this directory can't be used for inference via endpoints.\n\nCommand for running the server:\n### `(venv) username@pc:~/lumen-geoguesser$ python3 src/app/main.py`\n\n",
		"version": "0.1.0"
	},
	"paths": {
		"/models": {
			"get": {
				"tags": [
					"available models"
				],
				"summary": "Get Models",
				"description": "Returns names of all available models on the server. You must use model names for all `POST` request predictions. Model name is a stem of the model checkpoint, e.g. model with filename `my_model.ckpt` has the name `my_model`. Models are fetched from the directory `MODEL_DIRECTORY` which is defined in the `.env` file. Only models with the extension `MODEL_EXTENSION` are fetched. Model names will be returned instead of the model filenames.",
				"operationId": "get_models_models_get",
				"responses": {
					"200": {
						"description": "Successful Response",
						"content": {
							"application/json": {
								"schema": {
									"title": "Response Get Models Models Get",
									"type": "array",
									"items": {
										"type": "string",
										"format": "path"
									}
								}
							}
						}
					}
				}
			}
		},
		"/model/dataset-types": {
			"get": {
				"tags": [
					"available models"
				],
				"summary": "Get Supported Datasets",
				"description": "Returns names of all available models on the server. You must use model names for all `POST` request predictions. Model name is a stem of the model checkpoint, e.g. model with filename `my_model.ckpt` has the name `my_model`. Models are fetched from the directory `MODEL_DIRECTORY` which is defined in the `.env` file. Only models with the extension `MODEL_EXTENSION` are fetched. Model names will be returned instead of the model filenames.",
				"operationId": "get_supported_datasets_model_dataset_types_get",
				"responses": {
					"200": {
						"description": "Successful Response",
						"content": {
							"application/json": {
								"schema": {
									"title": "Response Get Supported Datasets Model Dataset Types Get",
									"type": "array",
									"items": {
										"type": "string"
									}
								}
							}
						}
					}
				}
			}
		},
		"/model/test-directory-stream": {
			"post": {
				"tags": [
					"predict"
				],
				"summary": "Test Directory Stream",
				"description": "Infers latitude and longitude for multiple images. If you have a group of images where each image represents one cardinal direction (north, east, south, and west) (\"0.jpg\", ... , \"270.jpg\") you should use the `/model/{model_name}/predict-cardinal-images endpoint",
				"operationId": "test_directory_stream_model_test_directory_stream_post",
				"parameters": [
					{
						"required": true,
						"schema": {
							"title": "Model Checkpoint",
							"type": "string",
							"format": "path"
						},
						"name": "model_checkpoint",
						"in": "query"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"title": "Dataset Dirs",
								"type": "array",
								"items": {
									"$ref": "#/components/schemas/TypeDatasetDict"
								}
							}
						}
					},
					"required": true
				},
				"responses": {
					"200": {
						"description": "Successful Response",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/PredictionsWithMetrics"
								}
							}
						}
					},
					"422": {
						"description": "Validation Error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/HTTPValidationError"
								}
							}
						}
					}
				}
			}
		},
		"/model/test-directory": {
			"post": {
				"tags": [
					"predict"
				],
				"summary": "Test Directory",
				"description": "Infers latitude and longitude for multiple images. If you have a group of images where each image represents one cardinal direction (north, east, south, and west) (\"0.jpg\", ... , \"270.jpg\") you should use the `/model/{model_name}/predict-cardinal-images endpoint",
				"operationId": "test_directory_model_test_directory_post",
				"parameters": [
					{
						"required": true,
						"schema": {
							"title": "Model Checkpoint",
							"type": "string",
							"format": "path"
						},
						"name": "model_checkpoint",
						"in": "query"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"title": "Dataset Dirs",
								"type": "array",
								"items": {
									"$ref": "#/components/schemas/TypeDatasetDict"
								}
							}
						}
					},
					"required": true
				},
				"responses": {
					"200": {
						"description": "Successful Response",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/PredictionsWithMetrics"
								}
							}
						}
					},
					"422": {
						"description": "Validation Error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/HTTPValidationError"
								}
							}
						}
					}
				}
			}
		},
		"/model/predict-directory-stream": {
			"post": {
				"tags": [
					"predict"
				],
				"summary": "Predict Directory Stream",
				"description": "Infers latitude and longitude for multiple images. If you have a group of images where each image represents one cardinal direction (north, east, south, and west) (\"0.jpg\", ... , \"270.jpg\") you should use the `/model/{model_name}/predict-cardinal-images endpoint",
				"operationId": "predict_directory_stream_model_predict_directory_stream_post",
				"parameters": [
					{
						"required": true,
						"schema": {
							"title": "Model Checkpoint",
							"type": "string",
							"format": "path"
						},
						"name": "model_checkpoint",
						"in": "query"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"title": "Dataset Dirs",
								"type": "array",
								"items": {
									"$ref": "#/components/schemas/TypeDatasetDict"
								}
							}
						}
					},
					"required": true
				},
				"responses": {
					"200": {
						"description": "Successful Response",
						"content": {
							"application/json": {
								"schema": {
									"title": "Response Predict Directory Stream Model Predict Directory Stream Post",
									"type": "object",
									"additionalProperties": {
										"$ref": "#/components/schemas/JsonPrediction"
									}
								}
							}
						}
					},
					"422": {
						"description": "Validation Error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/HTTPValidationError"
								}
							}
						}
					}
				}
			}
		},
		"/model/predict-directory": {
			"post": {
				"tags": [
					"predict"
				],
				"summary": "Predict Directory",
				"description": "Infers latitude and longitude for multiple images. If you have a group of images where each image represents one cardinal direction (north, east, south, and west) (\"0.jpg\", ... , \"270.jpg\") you should use the `/model/{model_name}/predict-cardinal-images endpoint",
				"operationId": "predict_directory_model_predict_directory_post",
				"parameters": [
					{
						"required": true,
						"schema": {
							"title": "Model Checkpoint",
							"type": "string",
							"format": "path"
						},
						"name": "model_checkpoint",
						"in": "query"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"title": "Dataset Dirs",
								"type": "array",
								"items": {
									"$ref": "#/components/schemas/TypeDatasetDict"
								}
							}
						}
					},
					"required": true
				},
				"responses": {
					"200": {
						"description": "Successful Response",
						"content": {
							"application/json": {
								"schema": {
									"title": "Response Predict Directory Model Predict Directory Post",
									"type": "object",
									"additionalProperties": {
										"$ref": "#/components/schemas/JsonPrediction"
									}
								}
							}
						}
					},
					"422": {
						"description": "Validation Error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/HTTPValidationError"
								}
							}
						}
					}
				}
			}
		},
		"/model/predict-files": {
			"post": {
				"tags": [
					"predict"
				],
				"summary": "Predict Files",
				"description": "Infers latitude and longitude for multiple images. If you have a group of images where each image represents one cardinal direction (north, east, south, and west) (\"0.jpg\", ... , \"270.jpg\") you should use the `/model/{model_name}/predict-cardinal-images endpoint",
				"operationId": "predict_files_model_predict_files_post",
				"parameters": [
					{
						"required": true,
						"schema": {
							"title": "Model Checkpoint",
							"type": "string",
							"format": "path"
						},
						"name": "model_checkpoint",
						"in": "query"
					}
				],
				"requestBody": {
					"content": {
						"multipart/form-data": {
							"schema": {
								"$ref": "#/components/schemas/Body_predict_files_model_predict_files_post"
							}
						}
					},
					"required": true
				},
				"responses": {
					"200": {
						"description": "Successful Response",
						"content": {
							"application/json": {
								"schema": {
									"title": "Response Predict Files Model Predict Files Post",
									"type": "array",
									"items": {
										"$ref": "#/components/schemas/JsonPrediction"
									}
								}
							}
						}
					},
					"422": {
						"description": "Validation Error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/HTTPValidationError"
								}
							}
						}
					}
				}
			}
		}
	},
	"components": {
		"schemas": {
			"Body_predict_files_model_predict_files_post": {
				"title": "Body_predict_files_model_predict_files_post",
				"required": [
					"audio_files"
				],
				"type": "object",
				"properties": {
					"audio_files": {
						"title": "Audio Files",
						"type": "array",
						"items": {
							"type": "string",
							"format": "binary"
						}
					}
				}
			},
			"TypeDatasetDict": {
				"title": "TypeDatasetDict",
				"required": [
					"dataset_type",
					"dataset_path"
				],
				"type": "object",
				"properties": {
					"dataset_type": {
						"$ref": "#/components/schemas/SupportedDatasetDirType"
					},
					"dataset_path": {
						"title": "Dataset Dir",
						"type": "string",
						"format": "path"
					}
				},
				"example": {
					"dataset_type": "irmastest",
					"dataset_path": "data/irmas/test"
				}
			},
			"HTTPValidationError": {
				"title": "HTTPValidationError",
				"type": "object",
				"properties": {
					"detail": {
						"title": "Detail",
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/ValidationError"
						}
					}
				}
			},
			"JsonPrediction": {
				"title": "JsonPrediction",
				"required": [
					"cel",
					"cla",
					"flu",
					"gac",
					"gel",
					"org",
					"pia",
					"sax",
					"tru",
					"vio",
					"voi"
				],
				"type": "object",
				"properties": {
					"cel": {
						"title": "Cel",
						"type": "number"
					},
					"cla": {
						"title": "Cla",
						"type": "number"
					},
					"flu": {
						"title": "Flu",
						"type": "number"
					},
					"gac": {
						"title": "Gac",
						"type": "number"
					},
					"gel": {
						"title": "Gel",
						"type": "number"
					},
					"org": {
						"title": "Org",
						"type": "number"
					},
					"pia": {
						"title": "Pia",
						"type": "number"
					},
					"sax": {
						"title": "Sax",
						"type": "number"
					},
					"tru": {
						"title": "Tru",
						"type": "number"
					},
					"vio": {
						"title": "Vio",
						"type": "number"
					},
					"voi": {
						"title": "Voi",
						"type": "number"
					}
				}
			},
			"PredictionsWithMetrics": {
				"title": "PredictionsWithMetrics",
				"required": [
					"accuracy",
					"hamming_distance",
					"f1",
					"precision",
					"recall",
					"predictions"
				],
				"type": "object",
				"properties": {
					"accuracy": {
						"title": "Accuracy",
						"type": "number"
					},
					"hamming_distance": {
						"title": "Hamming Distance",
						"type": "number"
					},
					"f1": {
						"title": "F1",
						"type": "number"
					},
					"precision": {
						"title": "Precision",
						"type": "number"
					},
					"recall": {
						"title": "Recall",
						"type": "number"
					},
					"predictions": {
						"title": "Predictions",
						"type": "object",
						"additionalProperties": {
							"$ref": "#/components/schemas/JsonPrediction"
						}
					}
				}
			},
			"SupportedDatasetDirType": {
				"title": "SupportedDatasetDirType",
				"enum": [
					"irmastrain",
					"irmastest",
					"openmic",
					"csv",
					"inference"
				],
				"description": "List of SupportedDatasetDirType we use."
			},
			"ValidationError": {
				"title": "ValidationError",
				"required": [
					"loc",
					"msg",
					"type"
				],
				"type": "object",
				"properties": {
					"loc": {
						"title": "Location",
						"type": "array",
						"items": {
							"anyOf": [
								{
									"type": "string"
								},
								{
									"type": "integer"
								}
							]
						}
					},
					"msg": {
						"title": "Message",
						"type": "string"
					},
					"type": {
						"title": "Error Type",
						"type": "string"
					}
				}
			}
		}
	},
	"tags": [
		{
			"name": "available models",
			"description": "All available models from the `MODEL_DIRECTORY` directory defined in the `.env` file"
		},
		{
			"name": "predict",
			"description": "Endpoints used for predicting latitude and longitudes for given data.\nCurl example for multiple images:\n\n```\ncurl -i \\\n-F \"images=@data/raw/images/train/e788b3d1-9d20-466c-9dee-97982f0f9a3b/0.jpg\" \\\n-F \"images=@data/raw/images/train/e788b3d1-9d20-466c-9dee-97982f0f9a3b/0.jpg\" \\\nhttp://0.0.0.0:8090/model/Golf_76__haversine_0.0098__val_acc_0.47__val_loss_1.98__05-04-03-36-32/predict-images\n```\n"
		}
	]
}
